// editorjs-undo@2.0.28 downloaded from https://ga.jspm.io/npm:editorjs-undo@2.0.28/dist/bundle.js

var v=typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:global;var b={};!function(v,g){b=g()}(self,(()=>(()=>{var b={917:function(b,g){var k,O;k=function(b){var g=function(){function t(v,b){for(var g=0;g<b.length;g++){var k=b[g];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(v,k.key,k)}}return function(v,b,g){return b&&t(v.prototype,b),g&&t(v,g),v}}(),k=function(){function t(b){(function(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")})(this||v,t),(this||v).target=b,(this||v).isContentEditable=b&&b.contentEditable}return g(t,[{key:"getPos",value:function(){if(document.activeElement!==(this||v).target)return-1;if("true"===(this||v).isContentEditable){(this||v).target.focus();var b=document.getSelection().getRangeAt(0),g=b.cloneRange();return g.selectNodeContents((this||v).target),g.setEnd(b.endContainer,b.endOffset),g.toString().length}return(this||v).target.selectionStart}},{key:"setPos",value:function(b){if("true"===(this||v).isContentEditable){if(b>=0){var g=window.getSelection(),k=this.createRange((this||v).target,{count:b});k&&(k.collapse(!1),g.removeAllRanges(),g.addRange(k))}}else(this||v).target.setSelectionRange(b,b)}},{key:"createRange",value:function(v,b,g){if(g||((g=document.createRange()).selectNode(v),g.setStart(v,0)),0===b.count)g.setEnd(v,b.count);else if(v&&b.count>0)if(v.nodeType===Node.TEXT_NODE)v.textContent.length<b.count?b.count-=v.textContent.length:(g.setEnd(v,b.count),b.count=0);else for(var k=0;k<v.childNodes.length&&(g=this.createRange(v.childNodes[k],b,g),0!==b.count);k++);return g}}]),t}();b.exports=k},void 0===(O=k.apply(g,[b]))||(b.exports=O)},442:(v,b,g)=>{v.exports=g(917)},633:(b,g,k)=>{var O=k(738).default;function o(){b.exports=o=function(){return k},b.exports.__esModule=!0,b.exports.default=b.exports;var g,k={},E=Object.prototype,L=E.hasOwnProperty,S=Object.defineProperty||function(v,b,g){v[b]=g.value},N="function"==typeof Symbol?Symbol:{},R=N.iterator||"@@iterator",M=N.asyncIterator||"@@asyncIterator",U=N.toStringTag||"@@toStringTag";function f(v,b,g){return Object.defineProperty(v,b,{value:g,enumerable:!0,configurable:!0,writable:!0}),v[b]}try{f({},"")}catch(g){f=function(v,b,g){return v[b]=g}}function d(v,b,g,k){var O=b&&b.prototype instanceof m?b:m,E=Object.create(O.prototype),L=new D(k||[]);return S(E,"_invoke",{value:T(v,g,L)}),E}function p(v,b,g){try{return{type:"normal",arg:v.call(b,g)}}catch(v){return{type:"throw",arg:v}}}k.wrap=d;var W="suspendedStart",A="suspendedYield",F="executing",H="completed",G={};function m(){}function x(){}function w(){}var K={};f(K,R,(function(){return this||v}));var J=Object.getPrototypeOf,Y=J&&J(J(I([])));Y&&Y!==E&&L.call(Y,R)&&(K=Y);var q=w.prototype=m.prototype=Object.create(K);function C(v){["next","throw","return"].forEach((function(b){f(v,b,(function(v){return this._invoke(b,v)}))}))}function j(b,g){function n(v,k,E,S){var N=p(b[v],b,k);if("throw"!==N.type){var R=N.arg,M=R.value;return M&&"object"==O(M)&&L.call(M,"__await")?g.resolve(M.__await).then((function(v){n("next",v,E,S)}),(function(v){n("throw",v,E,S)})):g.resolve(M).then((function(v){R.value=v,E(R)}),(function(v){return n("throw",v,E,S)}))}S(N.arg)}var k;S(this||v,"_invoke",{value:function(v,b){function i(){return new g((function(g,k){n(v,b,g,k)}))}return k=k?k.then(i,i):i()}})}function T(v,b,k){var O=W;return function(E,L){if(O===F)throw Error("Generator is already running");if(O===H){if("throw"===E)throw L;return{value:g,done:!0}}for(k.method=E,k.arg=L;;){var S=k.delegate;if(S){var N=B(S,k);if(N){if(N===G)continue;return N}}if("next"===k.method)k.sent=k._sent=k.arg;else if("throw"===k.method){if(O===W)throw O=H,k.arg;k.dispatchException(k.arg)}else"return"===k.method&&k.abrupt("return",k.arg);O=F;var R=p(v,b,k);if("normal"===R.type){if(O=k.done?H:A,R.arg===G)continue;return{value:R.arg,done:k.done}}"throw"===R.type&&(O=H,k.method="throw",k.arg=R.arg)}}}function B(v,b){var k=b.method,O=v.iterator[k];if(O===g)return b.delegate=null,"throw"===k&&v.iterator.return&&(b.method="return",b.arg=g,B(v,b),"throw"===b.method)||"return"!==k&&(b.method="throw",b.arg=new TypeError("The iterator does not provide a '"+k+"' method")),G;var E=p(O,v.iterator,b.arg);if("throw"===E.type)return b.method="throw",b.arg=E.arg,b.delegate=null,G;var L=E.arg;return L?L.done?(b[v.resultName]=L.value,b.next=v.nextLoc,"return"!==b.method&&(b.method="next",b.arg=g),b.delegate=null,G):L:(b.method="throw",b.arg=new TypeError("iterator result is not an object"),b.delegate=null,G)}function _(b){var g={tryLoc:b[0]};1 in b&&(g.catchLoc=b[1]),2 in b&&(g.finallyLoc=b[2],g.afterLoc=b[3]),(this||v).tryEntries.push(g)}function P(v){var b=v.completion||{};b.type="normal",delete b.arg,v.completion=b}function D(b){(this||v).tryEntries=[{tryLoc:"root"}],b.forEach(_,this||v),this.reset(!0)}function I(v){if(v||""===v){var b=v[R];if(b)return b.call(v);if("function"==typeof v.next)return v;if(!isNaN(v.length)){var k=-1,E=function n(){for(;++k<v.length;)if(L.call(v,k))return n.value=v[k],n.done=!1,n;return n.value=g,n.done=!0,n};return E.next=E}}throw new TypeError(O(v)+" is not iterable")}return x.prototype=w,S(q,"constructor",{value:w,configurable:!0}),S(w,"constructor",{value:x,configurable:!0}),x.displayName=f(w,U,"GeneratorFunction"),k.isGeneratorFunction=function(v){var b="function"==typeof v&&v.constructor;return!!b&&(b===x||"GeneratorFunction"===(b.displayName||b.name))},k.mark=function(v){return Object.setPrototypeOf?Object.setPrototypeOf(v,w):(v.__proto__=w,f(v,U,"GeneratorFunction")),v.prototype=Object.create(q),v},k.awrap=function(v){return{__await:v}},C(j.prototype),f(j.prototype,M,(function(){return this||v})),k.AsyncIterator=j,k.async=function(v,b,g,O,E){void 0===E&&(E=Promise);var L=new j(d(v,b,g,O),E);return k.isGeneratorFunction(b)?L:L.next().then((function(v){return v.done?v.value:L.next()}))},C(q),f(q,U,"Generator"),f(q,R,(function(){return this||v})),f(q,"toString",(function(){return"[object Generator]"})),k.keys=function(v){var b=Object(v),g=[];for(var k in b)g.push(k);return g.reverse(),function t(){for(;g.length;){var v=g.pop();if(v in b)return t.value=v,t.done=!1,t}return t.done=!0,t}},k.values=I,D.prototype={constructor:D,reset:function(b){if((this||v).prev=0,(this||v).next=0,(this||v).sent=(this||v)._sent=g,(this||v).done=!1,(this||v).delegate=null,(this||v).method="next",(this||v).arg=g,(this||v).tryEntries.forEach(P),!b)for(var k in this||v)"t"===k.charAt(0)&&L.call(this||v,k)&&!isNaN(+k.slice(1))&&((this||v)[k]=g)},stop:function(){(this||v).done=!0;var b=(this||v).tryEntries[0].completion;if("throw"===b.type)throw b.arg;return(this||v).rval},dispatchException:function(b){if((this||v).done)throw b;var k=this||v;function r(v,O){return S.type="throw",S.arg=b,k.next=v,O&&(k.method="next",k.arg=g),!!O}for(var O=(this||v).tryEntries.length-1;O>=0;--O){var E=(this||v).tryEntries[O],S=E.completion;if("root"===E.tryLoc)return r("end");if(E.tryLoc<=(this||v).prev){var N=L.call(E,"catchLoc"),R=L.call(E,"finallyLoc");if(N&&R){if((this||v).prev<E.catchLoc)return r(E.catchLoc,!0);if((this||v).prev<E.finallyLoc)return r(E.finallyLoc)}else if(N){if((this||v).prev<E.catchLoc)return r(E.catchLoc,!0)}else{if(!R)throw Error("try statement without catch or finally");if((this||v).prev<E.finallyLoc)return r(E.finallyLoc)}}}},abrupt:function(b,g){for(var k=(this||v).tryEntries.length-1;k>=0;--k){var O=(this||v).tryEntries[k];if(O.tryLoc<=(this||v).prev&&L.call(O,"finallyLoc")&&(this||v).prev<O.finallyLoc){var E=O;break}}E&&("break"===b||"continue"===b)&&E.tryLoc<=g&&g<=E.finallyLoc&&(E=null);var S=E?E.completion:{};return S.type=b,S.arg=g,E?((this||v).method="next",(this||v).next=E.finallyLoc,G):this.complete(S)},complete:function(b,g){if("throw"===b.type)throw b.arg;return"break"===b.type||"continue"===b.type?(this||v).next=b.arg:"return"===b.type?((this||v).rval=(this||v).arg=b.arg,(this||v).method="return",(this||v).next="end"):"normal"===b.type&&g&&((this||v).next=g),G},finish:function(b){for(var g=(this||v).tryEntries.length-1;g>=0;--g){var k=(this||v).tryEntries[g];if(k.finallyLoc===b)return this.complete(k.completion,k.afterLoc),P(k),G}},catch:function(b){for(var g=(this||v).tryEntries.length-1;g>=0;--g){var k=(this||v).tryEntries[g];if(k.tryLoc===b){var O=k.completion;if("throw"===O.type){var E=O.arg;P(k)}return E}}throw Error("illegal catch attempt")},delegateYield:function(b,k,O){return(this||v).delegate={iterator:I(b),resultName:k,nextLoc:O},"next"===(this||v).method&&((this||v).arg=g),G}},k}b.exports=o,b.exports.__esModule=!0,b.exports.default=b.exports},738:v=>{function e(b){return v.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(v){return typeof v}:function(v){return v&&"function"==typeof Symbol&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},v.exports.__esModule=!0,v.exports.default=v.exports,e(b)}v.exports=e,v.exports.__esModule=!0,v.exports.default=v.exports},756:(b,g,k)=>{var O=k(633)();b.exports=O;try{v.regeneratorRuntime=O}catch(b){"object"==typeof globalThis?globalThis.regeneratorRuntime=O:Function("r","regeneratorRuntime = r")(O)}}},g={};function n(v){var k=g[v];if(void 0!==k)return k.exports;var O=g[v]={exports:{}};return b[v].call(O.exports,O,O.exports,n),O.exports}n.n=v=>{var b=v&&v.__esModule?()=>v.default:()=>v;return n.d(b,{a:b}),b},n.d=(v,b)=>{for(var g in b)n.o(b,g)&&!n.o(v,g)&&Object.defineProperty(v,g,{enumerable:!0,get:b[g]})},n.o=(v,b)=>Object.prototype.hasOwnProperty.call(v,b);var k={};return(()=>{function t(v,b,g,k,O,E,L){try{var S=v[E](L),N=S.value}catch(v){return void g(v)}S.done?b(N):Promise.resolve(N).then(k,O)}function e(b){return function(){var g=this||v,k=arguments;return new Promise((function(v,O){var E=b.apply(g,k);function s(b){t(E,v,O,s,c,"next",b)}function c(b){t(E,v,O,s,c,"throw",b)}s(void 0)}))}}function o(v){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(v){return typeof v}:function(v){return v&&"function"==typeof Symbol&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},o(v)}function i(v){var b=function(v,b){if("object"!=o(v)||!v)return v;var g=v[Symbol.toPrimitive];if(void 0!==g){var k=g.call(v,"string");if("object"!=o(k))return k;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(v)}(v);return"symbol"==o(b)?b:b+""}function a(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")}function s(v,b){for(var g=0;g<b.length;g++){var k=b[g];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(v,i(k.key),k)}}function c(v,b,g){return b&&s(v.prototype,b),g&&s(v,g),Object.defineProperty(v,"prototype",{writable:!1}),v}n.d(k,{default:()=>S});var b=n(756),g=n.n(b),O=n(442),E=n.n(O),L=function(){return c((function t(b,g,k){a(this||v,t),(this||v).holder=g,(this||v).observer=null,(this||v).debounceTimer=k,(this||v).mutationDebouncer=this.debounce((function(){b()}),(this||v).debounceTimer)}),[{key:"setMutationObserver",value:function(){var b=this||v,g=(this||v).holder.querySelector(".codex-editor__redactor");(this||v).observer=new MutationObserver((function(v){b.mutationHandler(v)})),(this||v).observer.observe(g,{childList:!0,attributes:!0,subtree:!0,characterData:!0,characterDataOldValue:!0})}},{key:"mutationHandler",value:function(b){var g=this||v,k=!1;b.forEach((function(v){switch(v.type){case"childList":v.target===g.holder?g.onDestroy():k=!0;break;case"characterData":k=!0;break;case"attributes":v.target.classList.contains("ce-block")||v.target.classList.contains("tc-toolbox")||(k=!0)}})),k&&this.mutationDebouncer()}},{key:"debounce",value:function(b,g){var k,O=this||v;return function(){for(var v=arguments.length,E=new Array(v),L=0;L<v;L++)E[L]=arguments[L];var S=O;clearTimeout(k),k=setTimeout((function(){return b.apply(S,E)}),g)}}},{key:"onDestroy",value:function(){var b=new CustomEvent("destroy");document.dispatchEvent(b),(this||v).observer.disconnect()}}])}();function p(v,b){var g=Object.keys(v);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(v);b&&(k=k.filter((function(b){return Object.getOwnPropertyDescriptor(v,b).enumerable}))),g.push.apply(g,k)}return g}function y(v){for(var b=1;b<arguments.length;b++){var g=null!=arguments[b]?arguments[b]:{};b%2?p(Object(g),!0).forEach((function(b){var k,O,E;k=v,O=b,E=g[b],(O=i(O))in k?Object.defineProperty(k,O,{value:E,enumerable:!0,configurable:!0,writable:!0}):k[O]=E})):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(g)):p(Object(g)).forEach((function(b){Object.defineProperty(v,b,Object.getOwnPropertyDescriptor(g,b))}))}return v}var S=function(){return c((function t(b){var g=this||v,k=b.editor,O=b.config,E=void 0===O?{}:O,S=b.onUpdate,N=b.maxLength;a(this||v,t);var R={maxLength:30,onUpdate:function(){},config:{debounceTimer:200,shortcuts:{undo:["CMD+Z"],redo:["CMD+Y","CMD+SHIFT+Z"]}}},M=k.blocks,U=k.caret,W=k.configuration,A=W.holder,F=W.defaultBlock,H=R.config.shortcuts,G=E.shortcuts,K=y(y({},H),G),J=Array.isArray(K.undo)?K.undo:[K.undo],Y=Array.isArray(K.redo)?K.redo:[K.redo],q=R.config.debounceTimer,Z=E.debounceTimer,z=void 0===Z?q:Z;(this||v).holder="string"==typeof A?document.getElementById(A):A,(this||v).editor=k,(this||v).defaultBlock=F,(this||v).blocks=M,(this||v).caret=U,(this||v).shouldSaveHistory=!0,(this||v).readOnly=W.readOnly,(this||v).maxLength=N||R.maxLength,(this||v).onUpdate=S||R.onUpdate,(this||v).config={debounceTimer:z,shortcuts:{undo:J,redo:Y}},new L((function(){return g.registerChange()}),(this||v).holder,(this||v).config.debounceTimer).setMutationObserver(),this.setEventListeners(),(this||v).initialItem=null,this.clear()}),[{key:"truncate",value:function(v,b){for(;v.length>b;)v.shift()}},{key:"initialize",value:function(b){var g="blocks"in b?b.blocks:b,k={index:g.length-1,state:g};(this||v).stack[0]=k,(this||v).initialItem=k}},{key:"clear",value:function(){(this||v).stack=(this||v).initialItem?[(this||v).initialItem]:[{index:0,state:[{type:(this||v).defaultBlock,data:{}}]}],(this||v).position=0,this.onUpdate()}},{key:"setReadOnly",value:function(){var b=(this||v).holder.querySelector(".ce-toolbox");(this||v).readOnly=!b}},{key:"registerChange",value:function(){var b=this||v;this.setReadOnly(),(this||v).readOnly||((this||v).editor&&(this||v).editor.save&&(this||v).shouldSaveHistory&&(this||v).editor.save().then((function(v){b.editorDidUpdate(v.blocks)&&b.save(v.blocks)})),(this||v).shouldSaveHistory=!0)}},{key:"editorDidUpdate",value:function(b){var g=(this||v).stack[(this||v).position].state;return!!b.length&&(b.length!==g.length||JSON.stringify(g)!==JSON.stringify(b))}},{key:"save",value:function(b){(this||v).position>=(this||v).maxLength&&this.truncate((this||v).stack,(this||v).maxLength),(this||v).position=Math.min((this||v).position,(this||v).stack.length-1),(this||v).stack=(this||v).stack.slice(0,(this||v).position+1);var g=(this||v).blocks.getCurrentBlockIndex(),k=(this||v).blocks.getBlocksCount(),O=g;b[g]||(O-=k-b.length);var E=!b[O]||"paragraph"!==b[O].type&&"header"!==b[O].type?null:this.getCaretIndex(g);(this||v).stack.push({index:O,state:b,caretIndex:E}),(this||v).position+=1,this.onUpdate()}},{key:"getCaretIndex",value:function(b){var g=(this||v).holder.getElementsByClassName("ce-block__content");return new(E())(g[b].firstChild).getPos()}},{key:"insertDeletedBlock",value:function(b,g,k){for(var O=0;O<b.length;O+=1)if(!g[O]||b[O].id!==g[O].id){(this||v).blocks.insert(b[O].type,b[O].data,{},O,!0),(this||v).caret.setToBlock(k,"end");break}}},{key:"blockWasDropped",value:function(v,b){return v.length===b.length&&v.some((function(v,g){return v.id!==b[g].id}))}},{key:"blockWasSkipped",value:function(v,b){return v.length!==b.length}},{key:"contentChangedInNoFocusBlock",value:function(v,b){return v!==b}},{key:"blockWasDeleted",value:function(v,b){return v.length>b.length}},{key:"contentWasCopied",value:function(v,b,g){return 0===Object.keys(v[g].data).length&&JSON.stringify(b[g+1])!==JSON.stringify(v[g+1])}},{key:"undo",value:(N=e(g().mark((function t(){var b,k,O,E,L,S,N,R,M,U,W;return g().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!this.canUndo()){g.next=47;break}if(b=(this||v).stack[(this||v).position],k=b.index,O=b.state,(this||v).position-=1,(this||v).shouldSaveHistory=!1,E=(this||v).stack[(this||v).position].index,L=(this||v).stack[(this||v).position],S=L.state,N=L.caretIndex,this.onUpdate(),R=(this||v).blocks.getBlocksCount(),S[E]||(E-=1,(this||v).stack[(this||v).position].index=E),!this.blockWasDeleted(S,O)){g.next=13;break}this.insertDeletedBlock(S,O,E),g.next=42;break;case 13:if(!this.contentWasCopied(S,O,E)){g.next=19;break}return g.next=16,(this||v).blocks.render({blocks:S});case 16:(this||v).caret.setToBlock(E,"end"),g.next=42;break;case 19:if(!(E<k&&this.blockWasSkipped(S,O))){g.next=25;break}return g.next=22,(this||v).blocks.delete(k);case 22:(this||v).caret.setToBlock(E,"end"),g.next=42;break;case 25:if(!(R>S.length)){g.next=31;break}return g.next=28,(this||v).blocks.render({blocks:S});case 28:this.setCaretIndex(E,N),g.next=42;break;case 31:if(!this.blockWasDropped(S,O)){g.next=37;break}return g.next=34,(this||v).blocks.render({blocks:S});case 34:(this||v).caret.setToBlock(E,"end"),g.next=42;break;case 37:if(!this.contentChangedInNoFocusBlock(E,k)){g.next=42;break}return M=(this||v).blocks.getBlockByIndex(k),U=M.id,g.next=41,(this||v).blocks.update(U,S[k].data);case 41:this.setCaretIndex(E,N);case 42:if(!(W=(this||v).blocks.getBlockByIndex(E))){g.next=47;break}return g.next=46,(this||v).blocks.update(W.id,S[E].data);case 46:this.setCaretIndex(E,N);case 47:case"end":return g.stop()}}),t,this||v)}))),function(){return N.apply(this||v,arguments)})},{key:"setCaretIndex",value:function(b,g){if(g&&-1!==g){var k=(this||v).holder.getElementsByClassName("ce-block__content"),O=new(E())(k[b].firstChild);setTimeout((function(){return O.setPos(g)}),50)}else(this||v).caret.setToBlock(b,"end")}},{key:"insertBlock",value:(S=e(g().mark((function t(b,k){return g().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(this||v).blocks.insert(b[k].type,b[k].data,{},k,!0);case 2:case"end":return g.stop()}}),t,this||v)}))),function(b,g){return S.apply(this||v,arguments)})},{key:"insertSkippedBlocks",value:(O=e(g().mark((function t(b,k,O){var E;return g().wrap((function(v){for(;;)switch(v.prev=v.next){case 0:for(E=b.length;E<k.length;E+=1)this.insertBlock(k,E);if(JSON.stringify(b[O-1])===JSON.stringify(k[O-1])){v.next=4;break}return v.next=4,this.updateModifiedBlock(k,O);case 4:case"end":return v.stop()}}),t,this||v)}))),function(b,g,k){return O.apply(this||v,arguments)})},{key:"updateModifiedBlock",value:(k=e(g().mark((function t(b,k){var O;return g().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(O=b[k-1],!(this||v).editor.blocks.getById(O.id)){g.next=3;break}return g.abrupt("return",(this||v).blocks.update(O.id,O.data));case 3:return g.abrupt("return",(this||v).blocks.render({blocks:b}));case 4:case"end":return g.stop()}}),t,this||v)}))),function(b,g){return k.apply(this||v,arguments)})},{key:"redo",value:(b=e(g().mark((function t(){var b,k,O,E,L,S,N;return g().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!this.canRedo()){g.next=27;break}if((this||v).position+=1,(this||v).shouldSaveHistory=!1,b=(this||v).stack[(this||v).position],k=b.index,O=b.state,E=b.caretIndex,(L=(this||v).stack[(this||v).position-1]).index,S=L.state,!this.blockWasDeleted(S,O)){g.next=11;break}return g.next=8,(this||v).blocks.delete();case 8:(this||v).caret.setToBlock(k,"end"),g.next=21;break;case 11:if(!this.blockWasSkipped(O,S)){g.next=17;break}return g.next=14,this.insertSkippedBlocks(S,O,k);case 14:(this||v).caret.setToBlock(k,"end"),g.next=21;break;case 17:if(!this.blockWasDropped(O,S)||1===(this||v).position){g.next=21;break}return g.next=20,(this||v).blocks.render({blocks:O});case 20:(this||v).caret.setToBlock(k,"end");case 21:if(this.onUpdate(),!(N=(this||v).blocks.getBlockByIndex(k))){g.next=27;break}return g.next=26,(this||v).blocks.update(N.id,O[k].data);case 26:this.setCaretIndex(k,E);case 27:case"end":return g.stop()}}),t,this||v)}))),function(){return b.apply(this||v,arguments)})},{key:"canUndo",value:function(){return!(this||v).readOnly&&(this||v).position>0}},{key:"canRedo",value:function(){return!(this||v).readOnly&&(this||v).position<this.count()}},{key:"count",value:function(){return(this||v).stack.length-1}},{key:"parseKeys",value:function(v){var b={CMD:/(Mac)/i.test(navigator.platform)?"metaKey":"ctrlKey",ALT:"altKey",SHIFT:"shiftKey"},g=v.slice(0,-1).map((function(v){return b[v]})),k=g.includes("shiftKey")&&2===v.length?v[v.length-1].toUpperCase():v[v.length-1].toLowerCase();return g.push(k),g}},{key:"setEventListeners",value:function(){var b=this||v,g=(this||v).holder,k=(this||v).config.shortcuts,O=k.undo,E=k.redo,L=O.map((function(v){return v.replace(/ /g,"").split("+")})),S=E.map((function(v){return v.replace(/ /g,"").split("+")})),N=L.map((function(v){return b.parseKeys(v)})),R=S.map((function(v){return b.parseKeys(v)})),u=function(v,b){return b.reduce((function(b,g){return b||function(v,b){return 3===b.length&&v[b[0]]&&v[b[1]]&&v.key.toLowerCase()===b[2]}(v,g)}),!1)},l=function(v,b,g){return!(!function(v,b){return b.reduce((function(b,g){return b||function(v,b){return 2===b.length&&v[b[0]]&&v.key.toLowerCase()===b[1]}(v,g)}),!1)}(v,b)||u(v,g))||!!u(v,b)},h=function(v){l(v,N,R)&&(v.preventDefault(),b.undo())},f=function(v){l(v,R,N)&&(v.preventDefault(),b.redo())};g.addEventListener("keydown",h),g.addEventListener("keydown",f),g.addEventListener("destroy",(function(){g.removeEventListener("keydown",h),g.removeEventListener("keydown",f)}))}}],[{key:"isReadOnlySupported",get:function(){return!0}}]);var b,k,O,S,N}()})(),k.default})()));var g=b;const k=b.Undo;export{k as Undo,g as default};

